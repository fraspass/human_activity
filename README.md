# Separating human and automated activity in computer network traffic data

This reposit contains Julia code used to separate human and automated activity on a single edge within a computer network. 

The methodology builds up on the algorithm for detection of periodicities suggested in Heard, Rubin-Delanchy and Lawson (2014). A given edge can be classified as automated with significant level <img src="https://rawgit.com/fraspass/human_activity/None/svgs/c745b9b57c145ec5577b82542b2df546.svg?invert_in_darkmode" align=middle width=10.5765pt height=14.15535pt/> according to the the <img src="https://rawgit.com/fraspass/human_activity/None/svgs/2ec6e630f199f589a2402fdf3e0289d5.svg?invert_in_darkmode" align=middle width=8.270625pt height=14.15535pt/>-value obtained from a Fourier's <img src="https://rawgit.com/fraspass/human_activity/None/svgs/3cf4fbd05970446973fc3d9fa3fe3c41.svg?invert_in_darkmode" align=middle width=8.43051pt height=14.15535pt/>-test. Using this method, the entire activity observed from the edge is discarded from further analysis. In many instances though, the the activity on edges in NetFlow data is a mixture between human and automated connections. Therefore, a mixture model for classification of the automated and human events on the edge is proposed. 

## Methodology

### Fourier analysis

Assume that <img src="https://rawgit.com/fraspass/human_activity/None/svgs/e2c473b0627500251619ee3222b5f1ba.svg?invert_in_darkmode" align=middle width=67.4223pt height=20.22207pt/> are the raw arrival times of events on an edge <img src="https://rawgit.com/fraspass/human_activity/None/svgs/0fa0326f423a749421f358bd1d3a1653.svg?invert_in_darkmode" align=middle width=53.675655pt height=22.46574pt/>, where <img src="https://rawgit.com/fraspass/human_activity/None/svgs/cbfb1b2a33b28eab8a3e59464768e810.svg?invert_in_darkmode" align=middle width=14.90874pt height=22.46574pt/> and <img src="https://rawgit.com/fraspass/human_activity/None/svgs/91aac9730317276af725abd8cef04ca9.svg?invert_in_darkmode" align=middle width=13.19637pt height=22.46574pt/> are client and server IP addresses. In NetFlow data, the <img src="https://rawgit.com/fraspass/human_activity/None/svgs/02ab12d0013b89c8edc7f0f2662fa7a9.svg?invert_in_darkmode" align=middle width=10.58706pt height=20.22207pt/>'s are expressed in seconds from the Unix epoch (January 1, 1970). From the raw arrival times, the counting process <img src="https://rawgit.com/fraspass/human_activity/None/svgs/bc26136196e30407c1303ffbe073b500.svg?invert_in_darkmode" align=middle width=33.721545pt height=24.6576pt/> counts the number of events up to time <img src="https://rawgit.com/fraspass/human_activity/None/svgs/4f4f4e395762a3af4575de74c019ebb5.svg?invert_in_darkmode" align=middle width=5.9361555pt height=20.22207pt/> from the beginning of the observation period. 

Given <img src="https://rawgit.com/fraspass/human_activity/None/svgs/de3e1f364fdb63b83b40dccd545f87da.svg?invert_in_darkmode" align=middle width=162.961755pt height=24.6576pt/>, where <img src="https://rawgit.com/fraspass/human_activity/None/svgs/2f118ee06d05f3c2d98361d9c30e38ce.svg?invert_in_darkmode" align=middle width=11.889405pt height=22.46574pt/> is the total observation time, the periodogram <img src="https://rawgit.com/fraspass/human_activity/None/svgs/ec6220dd5b1b0b041c2cef5a4282e12f.svg?invert_in_darkmode" align=middle width=51.502605pt height=31.14177pt/> can be calculated as follows:
<p align="center"><img src="https://rawgit.com/fraspass/human_activity/None/svgs/82d1c12d422abbbaf8fe5b36692b4478.svg?invert_in_darkmode" align=middle width=393.1422pt height=53.95467pt/></p>

The periodogram can be easily evaluated at the Fourier frequencies <img src="https://rawgit.com/fraspass/human_activity/None/svgs/3b3c77a3ac66bae7c20ee3ae896d4007.svg?invert_in_darkmode" align=middle width=197.334555pt height=24.6576pt/> using the Fast Fourier Transform (FFT). The presence of periodicities can be assessed using the Fourier's <img src="https://rawgit.com/fraspass/human_activity/None/svgs/3cf4fbd05970446973fc3d9fa3fe3c41.svg?invert_in_darkmode" align=middle width=8.43051pt height=14.15535pt/>-statistic:
<p align="center"><img src="https://rawgit.com/fraspass/human_activity/None/svgs/7610c527b41a3ca4260038f78e3cced2.svg?invert_in_darkmode" align=middle width=193.1853pt height=49.39704pt/></p>

The <img src="https://rawgit.com/fraspass/human_activity/None/svgs/2ec6e630f199f589a2402fdf3e0289d5.svg?invert_in_darkmode" align=middle width=8.270625pt height=14.15535pt/>-value associated with an observed value <img src="https://rawgit.com/fraspass/human_activity/None/svgs/edd8e1b4a643e8dd7ef5f1c2b1cbdc59.svg?invert_in_darkmode" align=middle width=15.165645pt height=22.63866pt/> of the test statistic for the null hypothesis <img src="https://rawgit.com/fraspass/human_activity/None/svgs/30074edb23bec8e7c47c584ff885e5b5.svg?invert_in_darkmode" align=middle width=20.216955pt height=22.46574pt/> of no periodicities is:
<p align="center"><img src="https://rawgit.com/fraspass/human_activity/None/svgs/421aed6839acec8510832567b32f26de.svg?invert_in_darkmode" align=middle width=413.19135pt height=52.381065pt/></p>

### Mixture modelling

## References

* Heard, N.A., Rubin-Delanchy, P.T.G. and Lawson, D.J. (2014). "Filtering automated polling traffic in computer network flow data". Proceedings - 2014 IEEE Joint Intelligence and Security Informatics Conference, JISIC 2014, 268-271. ([Link](https://ieeexplore.ieee.org/document/6975589/))
